{% load static %}

<!-- User Menu Dropdown -->
{% if user.is_authenticated %}
<div class="user-menu">
  <button class="user-avatar" id="userMenuBtn" aria-expanded="false" aria-haspopup="true" aria-label="Menu do usuário">
    <img src="https://yt3.googleusercontent.com/BfPo-vPga13k-FNXBAXodrt2dpt-9iLhmqz3L9_BcMwxxImYOcJdRAr3xFIZdM35g0xQAEfSCBI=s900-c-k-c0x00ffffff-no-rj" alt="Avatar do usuário" />
  </button>

  <!-- Letterboxd-Style Dropdown Menu -->
  <div class="user-dropdown" id="userDropdown" role="menu">
    <div class="user-dropdown-header">
      <img src="https://yt3.googleusercontent.com/BfPo-vPga13k-FNXBAXodrt2dpt-9iLhmqz3L9_BcMwxxImYOcJdRAr3xFIZdM35g0xQAEfSCBI=s900-c-k-c0x00ffffff-no-rj" alt="Avatar" class="user-dropdown-avatar" />
      <div class="user-dropdown-info">
        <p class="user-dropdown-name">{{ user.username|default:"Visitante" }}</p>
      </div>
    </div>

    <a href="{% url 'backstage:perfil' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <img src="{% static 'images/User.png' %}" alt="Perfil" width="18" height="18" style="filter: brightness(0) invert(1); opacity: 0.7;">
      Perfil
    </a>

    <a href="{% url 'backstage:diary' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Meu Diário
    </a>

    <a href="{% url 'backstage:reviews' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Reviews
    </a>

    <a href="{% url 'backstage:watchlist' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      Watchlist
    </a>

    <a href="{% url 'backstage:favoritos' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 29 39" fill="none" style="opacity: 0.7;">
        <path d="M1.72505 34.5051L2.05744 35.7208C2.11819 35.943 2.2334 36.1465 2.39265 36.3129C2.95883 36.9045 3.91204 36.8782 4.44466 36.2561L13.7613 25.3749C14.1532 24.9172 14.8579 24.9075 15.2622 25.3542L24.3211 35.3616C25.1134 36.2368 26.5154 36.1413 27.1816 35.1667C27.389 34.8632 27.5 34.5042 27.5 34.1366V18.3989V14.0676C27.5 12.889 27.2916 11.7196 26.8845 10.6136L26.4758 9.50293C26.0782 8.42285 25.4972 7.4195 24.7584 6.53707L24.1058 5.75772C23.7691 5.35564 23.4013 4.98067 23.0059 4.63627L22.5401 4.2307C21.9488 3.71572 21.2989 3.27209 20.6039 2.90895L20.3611 2.7821C19.4918 2.32788 18.5603 2.00403 17.5967 1.82094L16.8325 1.67575C15.9318 1.50461 15.0118 1.45815 14.0984 1.53769L12.8183 1.64917C11.9926 1.72107 11.1791 1.89534 10.3964 2.16798L9.13134 2.60864C8.16615 2.94485 7.25821 3.42703 6.43916 4.03839L6.06743 4.31586C5.62325 4.64741 5.2074 5.01531 4.82418 5.41577L4.55395 5.69815C4.03629 6.23911 3.58102 6.8365 3.19669 7.47908L3.05731 7.71213C2.45709 8.71569 2.03754 9.81675 1.81773 10.9653L1.67827 11.6939C1.55969 12.3135 1.5 12.9429 1.5 13.5737V30.6254V32.8286C1.5 33.395 1.57569 33.9588 1.72505 34.5051Z" stroke="currentColor" stroke-width="3"/>
      </svg>
      Favoritos
    </a>

    <a href="{% url 'backstage:amigos' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Amigos
    </a>

    <div class="user-dropdown-divider"></div>

    <a href="{% url 'backstage:configuracoes' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <img src="{% static 'images/configurações.png' %}" alt="Configurações" width="18" height="18" style="filter: brightness(0) invert(1); opacity: 0.7;">
      Configurações
    </a>

    <a href="{% url 'backstage:ajuda' %}" class="user-dropdown-item" role="menuitem" tabindex="0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <path d="M12 16v-4m0-4h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      Ajuda
    </a>

    <div class="user-dropdown-divider"></div>

    <a href="{% url 'backstage:sair' %}" class="user-dropdown-item logout-item" role="menuitem" tabindex="0">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <path d="M16 17l5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      Sair
    </a>
  </div>
</div>
{% else %}
<a href="{% url 'backstage:login' %}" class="btn btn-secondary">Entrar</a>
{% endif %}
