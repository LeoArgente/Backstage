{% extends 'base.html' %}

{% block content %}
<h2>Adicionar crítica para: {{ filme.titulo }}</h2>

<form method="POST">
    {% csrf_token %}
    <div class="form-group">
        <label for="texto">Crítica:</label>
        <textarea id="texto" name="texto" class="form-control" rows="5" required></textarea>
    </div>

    <div class="form-group">
        <label>Nota:</label>
        <div class="estrelas"></div>
    </div>

    <button type="submit" class="btn btn-primary">Enviar crítica</button>
</form>
{% endblock %}

{% block extra_css %}
<style>
/* Container de estrelas */
.estrelas {
    display: flex;
    flex-direction: row-reverse; /* maior valor à esquerda */
    justify-content: flex-end;
    gap: 0.1rem;
    font-size: 2rem;
}

/* Esconde os radios */
.estrelas input {
    display: none;
}

/* Estrela base */
.estrelas label {
    position: relative;
    cursor: pointer;
    color: #ccc;
}

/* Estrela inteira */
.estrelas label::before {
    content: '★';
    display: block;
}

/* Estrela preenchida */
.estrelas input:checked ~ label::before {
    color: gold;
}

/* Hover */
.estrelas label:hover,
.estrelas label:hover ~ label {
    color: gold;
}

/* Meia estrela */
.estrelas label.half::before {
    content: '★';
    position: absolute;
    left: 0;
    width: 50%;
    overflow: hidden;
    color: gold;
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    const container = document.querySelector(".estrelas");
    const notas = [5.0,4.5,4.0,3.5,3.0,2.5,2.0,1.5,1.0,0.5];

    notas.forEach(valor => {
        const input = document.createElement("input");
        input.type = "radio";
        input.id = "nota" + valor;
        input.name = "nota";
        input.value = valor;

        const label = document.createElement("label");
        label.htmlFor = input.id;
        label.title = valor + " estrelas";

        // Se for valor quebrado (.5), aplica meia estrela
        if (valor % 1 !== 0) {
            label.classList.add("half");
        }

        container.appendChild(input);
        container.appendChild(label);
    });
});
</script>
{% endblock %}

