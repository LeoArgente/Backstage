{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Configurações — Backstage</title>
  <link rel="icon" type="image/png" href="{% static 'images/Icone_Backstage.png' %}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <link rel="stylesheet" href="{% static 'css/dropdown.css' %}">
  <link rel="stylesheet" href="{% static 'css/configuracoes.css' %}">
  <link rel="stylesheet" href="{% static 'css/mobile.css' %}">
</head>
<body>
  {% include 'backstage/_mobile_header.html' %}

  <header class="site-header">
    <div class="container">
      <nav class="nav-primary">
        <a class="brand" href="{% url 'backstage:index' %}">
          <img src="{% static 'images/Logo_Backstage_branca.png' %}"
               alt="Backstage Logo"
               width="250">
        </a>

        <div class="nav-menu">
          <a href="{% url 'backstage:index' %}" class="nav-link">Início</a>
          <a href="{% url 'backstage:movies' %}" class="nav-link">Filmes</a>
          <a href="{% url 'backstage:series' %}" class="nav-link">Séries</a>
          <a href="{% url 'backstage:lists' %}" class="nav-link">Listas</a>
          <a href="{% url 'backstage:comunidade' %}" class="nav-link">Comunidade</a>
        </div>

        <div class="nav-actions">
          <form method="get" action="{% url 'backstage:buscar' %}" class="search-container">
            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none">
              <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
              <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <input type="search" name="q" class="search-input" placeholder="Buscar filmes, séries..." autocomplete="off" />
            <input type="hidden" name="tipo" value="titulo" />
          </form>

          {% include 'backstage/_notifications.html' %}

          {% include 'backstage/_user_dropdown.html' %}
        </div>
      </nav>
    </div>
  </header>

  <!-- Mensagens do Django -->
  {% if messages %}
    <div class="messages-container">
      {% for message in messages %}
        <div class="message message-{{ message.tags }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <main class="settings-container">
    <div class="settings-layout">
      <!-- Menu Lateral -->
      <aside class="settings-sidebar">
        <nav class="settings-nav">
          <button class="settings-nav-item active" data-section="conta">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/>
              <path d="M4 20c0-4 3.5-6 8-6s8 2 8 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span>Conta</span>
          </button>

          <button class="settings-nav-item" data-section="perfil">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
              <path d="M7 18c0-2 2-3 5-3s5 1 5 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span>Perfil</span>
          </button>

          <button class="settings-nav-item" data-section="codigo">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M12 2L2 7l10 5 10-5-10-5z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
              <path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Resgatar Código</span>
          </button>
        </nav>
      </aside>

      <!-- Área de Conteúdo -->
      <div class="settings-content">
        <!-- Seção Conta -->
        <section class="settings-section active" id="section-conta">
          <div class="form-card">
            <div class="settings-header">
              <h1>Configurações de Conta</h1>
              <p>Gerencie suas informações de login e dados pessoais</p>
            </div>

            <form method="post" enctype="multipart/form-data">
              {% csrf_token %}
              <input type="hidden" name="secao" value="conta">

              <h2>Informações da Conta</h2>

              <div class="form-group">
                <label for="username">Nome de usuário</label>
                <input type="text" id="username" name="username" value="{{ user.username }}" class="form-input" required>
                <span class="form-help">Seu nome de usuário único no Backstage</span>
              </div>

              <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" value="{{ user.email }}" class="form-input" required>
                <span class="form-help">Usado para recuperação de senha e notificações</span>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">Salvar Alterações</button>
              </div>
            </form>

            <div class="section-divider"></div>

            <h2>Senha</h2>
            <p class="section-description">Mantenha sua conta segura com uma senha forte</p>
            <div class="form-actions">
              <button type="button" class="btn btn-secondary" onclick="alert('Funcionalidade de alterar senha em breve!')">Alterar Senha</button>
            </div>

            <div class="section-divider"></div>

            <h2 class="text-danger">Zona de Perigo</h2>
            <p class="section-description">Ações irreversíveis relacionadas à sua conta</p>
            <div class="form-actions">
              <button type="button" class="btn btn-danger" onclick="if(confirm('Tem certeza que deseja excluir sua conta? Esta ação não pode ser desfeita.')) alert('Funcionalidade de excluir conta em breve!')">Excluir Conta</button>
            </div>
          </div>
        </section>

        <!-- Seção Perfil -->
        <section class="settings-section" id="section-perfil">
          <div class="form-card">
            <div class="settings-header">
              <h1>Configurações de Perfil</h1>
              <p>Personalize seu perfil público no Backstage</p>
            </div>

            <form method="post" enctype="multipart/form-data">
              {% csrf_token %}
              <input type="hidden" name="secao" value="perfil">

              <h2>Foto de Perfil</h2>

              <div class="profile-photo-section">
                <div class="profile-photo-preview">
                  {% if profile.foto_perfil %}
                    <img src="{{ profile.foto_perfil.url }}" alt="Foto de perfil" id="foto-preview">
                  {% else %}
                    <img src="{% static 'images/default-avatar.png' %}" alt="Foto de perfil" id="foto-preview">
                  {% endif %}
                </div>
                <div class="profile-photo-actions">
                  <label for="foto_perfil" class="btn btn-secondary">
                    Escolher Foto
                    <input type="file" id="foto_perfil" name="foto_perfil" accept="image/*" style="display: none;">
                  </label>
                  {% if profile.foto_perfil %}
                    <button type="button" class="btn btn-danger" id="btn-remover-foto">Remover Foto</button>
                  {% endif %}
                  <span class="form-help">JPG, PNG ou GIF. Máximo 5MB.</span>
                </div>
              </div>

              <div class="section-divider"></div>

              <h2>Informações do Perfil</h2>

              <div class="form-group">
                <label for="bio">Biografia</label>
                <textarea id="bio" name="bio" class="form-textarea" rows="4" maxlength="500" placeholder="Conte um pouco sobre você e seus gostos cinematográficos...">{{ profile.bio|default:'' }}</textarea>
                <span class="form-help">Máximo 500 caracteres</span>
              </div>

              <h3>Redes Sociais</h3>

              <div class="form-group">
                <label for="instagram">Instagram</label>
                <input type="url" id="instagram" name="instagram" value="{{ profile.instagram|default:'' }}" class="form-input" placeholder="https://instagram.com/seu_usuario">
              </div>

              <div class="form-group">
                <label for="twitter">Twitter</label>
                <input type="url" id="twitter" name="twitter" value="{{ profile.twitter|default:'' }}" class="form-input" placeholder="https://twitter.com/seu_usuario">
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">Salvar Perfil</button>
              </div>
            </form>
          </div>
        </section>

        <!-- Seção Resgatar Código -->
        <section class="settings-section" id="section-codigo">
          <div class="form-card">
            <div class="settings-header">
              <h1>Resgatar Código</h1>
              <p>Desbloqueie badges exclusivos com códigos especiais</p>
            </div>

            <form method="post">
              {% csrf_token %}
              <input type="hidden" name="secao" value="codigo">

              <h2>Insira seu Código</h2>
              <p class="section-description">Códigos podem ser encontrados em eventos, produtos físicos ou promoções especiais do Backstage</p>

              <div class="form-group">
                <label for="codigo">Código</label>
                <input type="text" id="codigo" name="codigo" class="form-input" placeholder="XXXX-XXXX-XXXX" style="text-transform: uppercase;">
                <span class="form-help">Digite o código exatamente como aparece</span>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary">Resgatar Código</button>
              </div>
            </form>

            <div class="section-divider"></div>

            <h2>Meus Badges</h2>
            <div class="badges-container">
              <div class="empty-state">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                  <path d="M12 2L2 7l10 5 10-5-10-5z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                  <path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <p>Você ainda não possui badges</p>
                <span>Resgate códigos para começar sua coleção!</span>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>

  <script src="{% static 'js/profile_menu.js' %}"></script>
  <script src="{% static 'js/configuracoes.js' %}"></script>
  <script src="{% static 'js/notifications.js' %}" defer></script>
</body>

{% include 'backstage/footer_default.html' %}

</html>
